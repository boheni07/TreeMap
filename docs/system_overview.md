# TreeMap (Project Antigravity) 시스템 상세 설명서

본 문서는 스마트폰 센서와 AI를 활용한 수목 측정 시스템인 'TreeMap (Project Antigravity)'의 기능, UI, 수집 데이터 및 AI 모델에 대한 상세 명세를 제공합니다.

---

## 1. 시스템 주요 기능
- **수목 측정 (Tree Metrology)**:
    - **흉고직경 (DBH)**: 나무의 지상 약 1.2m 높이에서의 직경을 비접촉 방식으로 정밀 측정합니다.
    - **수고 (Tree Height)**: 삼각측량 기법을 활용하여 나무의 전체 높이를 산출합니다.
    - **수목 위치 (Location)**: 측정된 수목의 정확한 GPS 좌표를 수집하고 지도로 시각화합니다.
- **AI 분석**:
    - **수중 식별 (Species Identification)**: 카메라 영상을 분석하여 나무의 종류를 자동으로 판별합니다.
    - **건강도 진단 (Health Assessment)**: 수목의 잎, 줄기 상태를 분석하여 건강 상태를 점수로 환산합니다.

## 2. 사용자 인터페이스 (UI) 구성
- **실시간 카메라 프리뷰**: 측정 대상 수목을 화면에 실시간으로 표시합니다.
- **스마트 가이드 시스템**:
    - **수목 실루엣 오버레이**: 측정 범위를 가이드하는 나무 모양의 반투명 아이콘을 중앙에 배치합니다.
    - **물방울 수평계 (Water Drop Level)**: 센서 데이터를 바탕으로 기기의 수직 상태를 시각화하여 측정의 정확도를 높입니다 (녹색: 수직 정렬 완료).
    - **1.2m (DBH) 가변 포인트**: 사용자 키와 기기 기울기를 계산하여 실제 나무의 1.2m 지점에 해당하는 곳에 RED Crosshair를 표시합니다.
- **컨트롤 레이어**: 
    - **측정 버튼**: 기기가 수직으로 정렬되었을 때만 활성화되어 정확한 데이터 캡처를 유도합니다.
    - **설정 메뉴**: 사용자 키(렌즈 높이) 등 정밀 측정에 필요한 파라미터를 설정합니다.

## 3. 수집하는 스마트폰 정보
시스템은 정밀한 계산을 위해 다음 센서 및 사용자 정보를 활용합니다.
- **모션 센서 (IMU)**:
    - **가속도계 (Accelerometer)**: 기기의 기울기(Pitch) 각도를 실시간으로 수집합니다.
- **이미지 데이터 (Camera)**:
    - **영상 프레임**: 실시간 추론 및 공간 분석을 위한 시각 정보를 수집합니다.
- **위치 정보 (GPS/GNSS)**:
    - **수목 좌표**: 측정 시점의 위도, 경도 및 고도 데이터를 기록합니다.
- **사용자 입력 데이터**:
    - **사용자 안구/렌즈 높이**: 삼각측량의 기준선(Baseline) 데이터를 수집합니다.

## 4. 활용 AI 모델 명세
온디바이스(On-device) 최적화를 위해 다음 고성능 경량 모델들을 사용합니다.
- **YOLOv11-seg**: 수목 줄기(Trunk) 영역을 정밀 분할(Segmentation)하여 픽셀 너비를 추출합니다.
- **MiDaS v2.1 Small**: 단안 카메라 이미지를 통해 상대적 깊이(Depth) 맵을 생성하고 거리 측정 보조 수단으로 활용합니다.
- **MobileNetV3**: 낮은 연산량으로 고정확도의 수종 분류(Classification)를 수행합니다.
- **EfficientNet-Lite**: 이미지 특징 추출을 통해 수목의 병해충 유무 및 건강도를 판별합니다.

## 5. AI 모델로 생성되는 출력 정보
- **기하학적 정보**: 
    - **Trunk Mask**: 나무 줄기의 정확한 형태 및 테두리 정보
    - **Predicted DBH**: 계산된 흉고직경(cm)
    - **Predicted Height**: 산출된 수고(m)
- **속성 정보**:
    - **Species Name**: 분류된 나무의 국명 및 학명
    - **Health Score**: 0~100 사이의 수목 건강 지수
- **공간 정보**:
    - **Corrected Coordinates**: 측정자와 나무 사이의 거리를 계산하여 보정된 실제 수목의 좌표
